<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Jason Wills Chiu">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>SQL and Pandas - Book 1 - Passing Data and Comparing Commands | Jason Wills Chiu</title>
        <!-- to get highcharts to work -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title="Jason Wills Chiu blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/icons.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}

   /*navbar background color and settings*/
.navbar {
  background-color: #0B3A62;
  border-bottom: 0px solid #0B3A62;

  /*display: block;*/
  float: none;
	line-height: 30px;
  /*position: relative;*/
	margin: 0 auto 2em auto;
	padding:0 30px;
  text-align: center;
  /*width: 100%;*/

}
/* trying some screen magic from Emmet*/
.highcharts-container { width: 100% }

/* checks screen size is at least that min width*/
@media (min-width: 1200px) {

    .navbar {
      width: 1200px;
      text-align: center;
    }

    /*.navbar .navbar-nav {
        display: inline-block;
        float: none;
        vertical-align: top;
        text-align: center;
    }

    .navbar .navbar-collapse {
        text-align: center;
    }*/
}

/* the navbar title text color */
.navbar .navbar-brand, .navbar-brand:hover {
      color: #ECEEFF;
      background: #0B3A62;
    }

  /* navbar links on the right text  */
.nav.navbar-nav li a {
    color: #ECEEFF;
    font-size: 16px
    /*display:inline;*/
}

  /* Added to remove ugly pilcrow (reverse p) */
.anchor-link {
  font-size: 0;
}


/* start of jakevdp default */

a {
  color: #007EE5;
  text-decoration: none;
}
a:hover {
  color: #007EE5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #0B3A62;
  margin-bottom: 0px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  /*max-width: 1000px;*/
  text-align: center;
}
header.main-header .container nav a:hover {
  background-color: #0D406E;
  text-align: center;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  margin-bottom: 20px;
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #d1d1d1;
  font-size: 0.85em;
  float: right;
}
article header time.left {
  color: #d1d1d1;
  font-size: 0.85em;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 16px;
  margin-bottom: 20px;
  line-height: 1.6em;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 13px;
}
article .meta {
  font-size: 11px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  margin-bottom: 20px;
  display: block;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #0B3A62;
  background: #FFF;
  border: 1px solid #0B3A62;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #0D406E;
}
.index {
  max-width: 1000px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
.index article header h2 a {
  color: #000;
}
.index article header h2 a:hover {
  color: #007EE5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #0D406E;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #0D406E;
}
.index .pagination a:hover {
  color: #FFF;
  background: #0D406E;
}
.post {
  max-width: 1000px;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post article .meta {
  margin: 50px 0 100px;
}
.list {
  max-width: 1000px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 1em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}</style>

        <!-- to view highcharts -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
      	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->

        <!-- Loading mathjax macro -->
        <!-- Load mathjax -->
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
            <!-- MathJax configuration -->
            <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                // Center justify equations in code and markdown cells. Elsewhere
                // we use CSS to left justify single line equations in code cells.
                displayAlign: 'center',
                "HTML-CSS": {
                    styles: {'.MathJax_Display': {"margin": 0}},
                    linebreaks: { automatic: true }
                }
            });
            </script>
            <!-- End of mathjax configuration --></head>

    </head>

    <body>
        <header class="navbar navbar-inverse bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title">Jason Wills Chiu</a>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav">
                            <li><a href="/pages/about.html" title="About">About</a></li>
                            <li><a href="/archives.html" title="Archive">Archive</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>SQL and Pandas - Book 1 - Passing Data and Comparing Commands</h1>
            <time datetime="article.date.isoformat()" pubdate>Mon 05 February 2018</time>
        </header>

        <div class="article_content">
            <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<p>In this notebook we will practice SQL and parallel our actions with the Pandas library (Python).</p>
<p><strong>Results</strong>
<br/> With the SQL perspective we learn SELECT, WHERE, GROUP BY, JOIN, UNION and Common Table Expressions (WITH).</p>
<p>From a Python perspective we learned how to read and write into SQL and the libraries needed to interact with PostgreSQL:</p>
<ul>
<li>psycopg2. A Python adaptor to interact with PostgreSQL</li>
<li>SQLAlchemy. A Python SQL toolkit. We'll be using it primarily to read and write dataframes between Python and SQL</li>
<li>SQL Magic. A Python library that allows us to run SQL commands inside jupyter notebooks. Commands start with %sql or %%sql</li>
</ul>
<p><strong>Limitations</strong>
<br/> Only used PostgreSQL and there are many more examples we can cover.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h1>Table of Contents<span class="tocSkip"></span></h1></p>
<div class="toc" style="margin-top: 1em;"><ul class="toc-item"><li><span><a data-toc-modified-id="Python-Setup-to-interact-with-SQL-1" href="#Python-Setup-to-interact-with-SQL">Python Setup to interact with SQL</a></span><ul class="toc-item"><li><span><a data-toc-modified-id="A-quick-clean-so-we-can-begin-the-tutorial-1.1" href="#A-quick-clean-so-we-can-begin-the-tutorial">A quick clean so we can begin the tutorial</a></span></li></ul></li><li><span><a data-toc-modified-id="SQL-and-Pandas-cheatsheet-2" href="#SQL-and-Pandas-cheatsheet">SQL and Pandas cheatsheet</a></span><ul class="toc-item"><li><span><a data-toc-modified-id="SELECT-(SQL)-and-selecting-(Pandas)-2.1" href="#SELECT-(SQL)-and-selecting-(Pandas)">SELECT (SQL) and selecting (Pandas)</a></span></li><li><span><a data-toc-modified-id="WHERE-(SQL)-and-filtering-(Pandas)-2.2" href="#WHERE-(SQL)-and-filtering-(Pandas)">WHERE (SQL) and filtering (Pandas)</a></span><ul class="toc-item"><li><span><a data-toc-modified-id="Filtering-by-number-2.2.1" href="#Filtering-by-number">Filtering by number</a></span></li><li><span><a data-toc-modified-id="Filtering-by-String-2.2.2" href="#Filtering-by-String">Filtering by String</a></span></li><li><span><a data-toc-modified-id="Filtering-rows-that-contain-null-values-2.2.3" href="#Filtering-rows-that-contain-null-values">Filtering rows that contain null values</a></span></li></ul></li><li><span><a data-toc-modified-id="GROUP-BY-(SQL)-and-groupby-(Pandas)-2.3" href="#GROUP-BY-(SQL)-and-groupby-(Pandas)">GROUP BY (SQL) and groupby (Pandas)</a></span><ul class="toc-item"><li><span><a data-toc-modified-id="Grouping-with-count-and-sort-2.3.1" href="#Grouping-with-count-and-sort">Grouping with count and sort</a></span></li><li><span><a data-toc-modified-id="Grouping-with-average-2.3.2" href="#Grouping-with-average">Grouping with average</a></span></li></ul></li><li><span><a data-toc-modified-id="JOIN-(SQL)-and-merge-(Pandas)-2.4" href="#JOIN-(SQL)-and-merge-(Pandas)">JOIN (SQL) and merge (Pandas)</a></span><ul class="toc-item"><li><span><a data-toc-modified-id="Types-of-Joins-2.4.1" href="#Types-of-Joins">Types of Joins</a></span></li><li><span><a data-toc-modified-id="INNER-JOIN-(SQL)-and-how='inner'-(Pandas)-2.4.2" href="#INNER-JOIN-(SQL)-and-how='inner'-(Pandas)">INNER JOIN (SQL) and how='inner' (Pandas)</a></span></li></ul></li><li><span><a data-toc-modified-id="UNION-(SQL)-and-concat-(Pandas)-2.5" href="#UNION-(SQL)-and-concat-(Pandas)">UNION (SQL) and concat (Pandas)</a></span><ul class="toc-item"><li><span><a data-toc-modified-id="UNION-ALL-(SQL)-and-concat-(Pandas)-2.5.1" href="#UNION-ALL-(SQL)-and-concat-(Pandas)">UNION ALL (SQL) and concat (Pandas)</a></span></li><li><span><a data-toc-modified-id="UNION-(SQL)-and-concat-(Pandas)-2.5.2" href="#UNION-(SQL)-and-concat-(Pandas)">UNION (SQL) and concat (Pandas)</a></span></li></ul></li></ul></li><li><span><a data-toc-modified-id="More-examples-3" href="#More-examples">More examples</a></span><ul class="toc-item"><li><span><a data-toc-modified-id="Creating-a-median-function-3.1" href="#Creating-a-median-function">Creating a median function</a></span></li><li><span><a data-toc-modified-id="Common-Table-Expressions-(CTEs)-aka-WITH-clauses-3.2" href="#Common-Table-Expressions-(CTEs)-aka-WITH-clauses">Common Table Expressions (CTEs) aka WITH clauses</a></span></li><li><span><a data-toc-modified-id="Reading-from-SQL-3.3" href="#Reading-from-SQL">Reading from SQL</a></span></li></ul></li><li><span><a data-toc-modified-id="Conclusion-4" href="#Conclusion">Conclusion</a></span><ul class="toc-item"><li><span><a data-toc-modified-id="Limitations-4.1" href="#Limitations">Limitations</a></span></li><li><span><a data-toc-modified-id="Future-Work-4.2" href="#Future-Work">Future Work</a></span></li></ul></li><li><span><a data-toc-modified-id="References-5" href="#References">References</a></span></li></ul></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Python-Setup-to-interact-with-SQL">Python Setup to interact with SQL<a class="anchor-link" href="#Python-Setup-to-interact-with-SQL">¶</a></h1><hr/>
<p>We'll need a few things installed to begin:</p>
<ul>
<li><strong>PostgresSQL.</strong> The flavour of SQL we'll use.</li>
<li><strong>psycopg2.</strong> A Python adaptor to interact with PostgreSQL</li>
<li><strong>SQLAlchemy.</strong> A Python SQL toolkit. We'll be using it primarily to read and write dataframes between Python and SQL</li>
<li><strong>SQL Magic.</strong> A Python library that allows us to run SQL commands inside jupyter notebooks. Commands start with %sql or %%sql</li>
<li>Other standard Python libraries used (Pandas, Numpy, etc)</li>
</ul>
<p>I'm using a Windows 10 machine with PostgreSQL installed locally.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">create_engine</span>
<span class="o">%</span><span class="k">load_ext</span> sql
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We connect to our local PostgreSQL database in an unsecure fashion below. I'll create a credentials JSON file when we're not only testing.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">sql</span> postgresql+psycopg2://postgres:1@localhost:5432/fishing
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[2]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>'Connected: postgres@fishing'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We make sure our database is empty to start with.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span> 

DROP TABLE IF EXISTS journalv4, weatherv3, table1, table2, journalv3;
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Done.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So this command should show no columns.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT table_name
FROM information_schema.tables
WHERE table_schema NOT IN ('pg_catalog', 'information_schema');
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>table_name</th>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load our libraries and data from Google Sheets.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">'C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">JWC</span><span class="se">\\</span><span class="s1">Google Drive</span><span class="se">\\</span><span class="s1">Home</span><span class="se">\\</span><span class="s1">Datastuff</span><span class="se">\\</span><span class="s1">homepro</span><span class="se">\\</span><span class="s1">SQL-Pandas'</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">oauth2client.service_account</span> <span class="k">import</span> <span class="n">ServiceAccountCredentials</span>
<span class="kn">import</span> <span class="nn">pygsheets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">ipy_table</span> <span class="k">as</span> <span class="nn">tbl</span> <span class="c1"># for tables</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># Visuals</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">ezhc</span> <span class="k">as</span> <span class="nn">hc</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>

<span class="c1"># Check what was loaded</span>
<span class="o">%</span><span class="k">load_ext</span> version_information
<span class="o">%</span><span class="k">version_information</span> pandas, ipython, jupyter, ezhc, pygsheets, oauth2client
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div id="dbfb2179-0dc2-467f-89d8-d7d08f27408f"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#dbfb2179-0dc2-467f-89d8-d7d08f27408f');

require(["jquery", "https://code.highcharts.com/stock/highstock.js", "https://d3js.org/d3.v3.min.js"], function() {
    require(["https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js", "https://code.highcharts.com/stock/highcharts-more.js", "https://code.highcharts.com/modules/drilldown.js", "https://code.highcharts.com/modules/exporting.js", "https://code.highcharts.com/modules/heatmap.js", "https://code.highcharts.com/modules/treemap.js", "https://code.highcharts.com/modules/sunburst.js", "https://highcharts.github.io/export-csv/export-csv.js"], function() {
        console.log("The following js libs loaded:");
        console.log("First:");
        console.log("jquery");console.log("https://code.highcharts.com/stock/highstock.js");console.log("https://d3js.org/d3.v3.min.js");
        console.log("Then:");
        console.log("https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js");console.log("https://code.highcharts.com/stock/highcharts-more.js");console.log("https://code.highcharts.com/modules/drilldown.js");console.log("https://code.highcharts.com/modules/exporting.js");console.log("https://code.highcharts.com/modules/heatmap.js");console.log("https://code.highcharts.com/modules/treemap.js");console.log("https://code.highcharts.com/modules/sunburst.js");console.log("https://highcharts.github.io/export-csv/export-csv.js");
    });
});
</script>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table><tr><th>Software</th><th>Version</th></tr><tr><td>Python</td><td>3.6.1 64bit [MSC v.1900 64 bit (AMD64)]</td></tr><tr><td>IPython</td><td>6.2.1</td></tr><tr><td>OS</td><td>Windows 10 10.0.16299 SP0</td></tr><tr><td>pandas</td><td>0.22.0</td></tr><tr><td>ipython</td><td>6.2.1</td></tr><tr><td>jupyter</td><td>1.0.0</td></tr><tr><td>ezhc</td><td>0.7.1</td></tr><tr><td>pygsheets</td><td>1.1.3</td></tr><tr><td>oauth2client</td><td>4.1.2</td></tr><tr><td colspan="2">Mon Feb 05 15:47:18 2018 AUS Eastern Daylight Time</td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The authorisation part of accessing google sheets</span>
<span class="n">scope</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'https://spreadsheets.google.com/feeds'</span><span class="p">,</span>
        <span class="s1">'https://www.googleapis.com/auth/drive'</span><span class="p">]</span>
<span class="n">creds</span> <span class="o">=</span> <span class="n">ServiceAccountCredentials</span><span class="o">.</span><span class="n">from_json_keyfile_name</span><span class="p">(</span><span class="s1">'google_client_secret.json'</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">pygsheets</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">creds</span><span class="p">)</span>

<span class="c1"># Open a workbook by name</span>
<span class="c1"># Open a wooksheet by name</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">"Fishing Spots"</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet_by_title</span><span class="p">(</span><span class="s1">'Journalv3'</span><span class="p">)</span>

<span class="c1"># Get all values outputs a list of lists, easier to handle than list of dicts</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">get_as_df</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Date</th>
<th>Spot</th>
<th>Baits/Lures</th>
<th>Fish Caught</th>
<th>Water Temp</th>
<th>Swell</th>
<th>Wind</th>
<th>Time fished</th>
<th>In what tide</th>
<th>Moon phase</th>
<th>Rain</th>
<th>Sun / Cloud</th>
<th>Year</th>
<th>Month</th>
<th>Day</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td></td>
<td>2.3m</td>
<td>small SW</td>
<td>5:30am - 8:30am</td>
<td>7:40am high</td>
<td></td>
<td>None</td>
<td>Sunny</td>
<td>2010</td>
<td>9</td>
<td>9</td>
</tr>
<tr>
<th>1</th>
<td>2010-09-09</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td></td>
<td>2.3m</td>
<td>small SW</td>
<td>5:30am - 8:30am</td>
<td>7:40am high</td>
<td></td>
<td>None</td>
<td>Sunny</td>
<td>2010</td>
<td>9</td>
<td>9</td>
</tr>
<tr>
<th>2</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
<td></td>
<td>1.2m</td>
<td>small W</td>
<td>6 - 8 am</td>
<td>9:30am low</td>
<td></td>
<td>None</td>
<td>Sunny</td>
<td>2010</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<th>3</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td></td>
<td>1.2m</td>
<td>small W</td>
<td>6 - 8 am</td>
<td>9:30am low</td>
<td></td>
<td>None</td>
<td>Sunny</td>
<td>2010</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<th>4</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
<td></td>
<td>1.2m</td>
<td>small W</td>
<td>6 - 8 am</td>
<td>9:30am low</td>
<td></td>
<td>None</td>
<td>Sunny</td>
<td>2010</td>
<td>4</td>
<td>8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-quick-clean-so-we-can-begin-the-tutorial">A quick clean so we can begin the tutorial<a class="anchor-link" href="#A-quick-clean-so-we-can-begin-the-tutorial">¶</a></h2><hr/>
<ul>
<li>Swell - Extract only magnitude in meters</li>
<li>Water temp - remove °C</li>
<li>Moon phase - remove % full</li>
<li>Baits/Lures - rename to baits_lures</li>
</ul>
<p>PostgreSQL is picky about column names, which must be:</p>
<ul>
<li>all lowercase</li>
<li>no spaces</li>
<li>only allowable special character is _</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Make all column names lower case</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="c1"># Remove spaces and special characters from columns</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'baits_lures'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'baits/lures'</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'fish_caught'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'fish caught'</span><span class="p">]</span>

<span class="c1"># Remove °C from water temp and remove space</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'water_temp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'water temp'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'°C'</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'water_temp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'water_temp'</span><span class="p">],</span><span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>

<span class="c1"># Extract the number before 'm' for swell magnitude and remove space</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'swell_magnitude'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'swell'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">'^(.*?)m'</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'swell_magnitude'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'swell_magnitude'</span><span class="p">],</span><span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>

<span class="c1"># Extract the number before '%" for moon phase and remove space</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'moon_phase_percent_full'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'moon phase'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">'^(.*?)%'</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'moon_phase_percent_full'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'moon_phase_percent_full'</span><span class="p">],</span><span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">,</span><span class="n">downcast</span><span class="o">=</span><span class="s1">'integer'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Have a quick look at our variables. Since this is a tutorial notebook, we will only keep some columns.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>spot</th>
<th>baits/lures</th>
<th>fish caught</th>
<th>water temp</th>
<th>swell</th>
<th>wind</th>
<th>time fished</th>
<th>in what tide</th>
<th>moon phase</th>
<th>rain</th>
<th>sun / cloud</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>114</th>
<td>2015-04-26</td>
<td>Janies Corner</td>
<td>Mullet Fillet</td>
<td>3x butter bream</td>
<td>21.3°C</td>
<td>1.5m E 9.3sec</td>
<td>21knots W</td>
<td>7:30am - 8:30am</td>
<td>Outgoing 0.8-0.7m</td>
<td>50% full</td>
<td>no</td>
<td>sunny</td>
<td>2015</td>
<td>4</td>
<td>26</td>
<td>Mullet Fillet</td>
<td>3x butter bream</td>
<td>21.3</td>
<td>1.5</td>
<td>50.0</td>
</tr>
<tr>
<th>129</th>
<td>2015-06-12</td>
<td>The Boot</td>
<td>Squid leg</td>
<td>3x 30cm trevs</td>
<td>21.6°C</td>
<td>1.4m SE 11sec</td>
<td>7.2knots WSW</td>
<td>5:30am - 8am</td>
<td>Outgoing 1.3-0.8m</td>
<td>20% full</td>
<td>no</td>
<td>cloudy</td>
<td>2015</td>
<td>6</td>
<td>12</td>
<td>Squid leg</td>
<td>3x 30cm trevs</td>
<td>21.6</td>
<td>1.4</td>
<td>20.0</td>
</tr>
<tr>
<th>302</th>
<td>2016-12-04</td>
<td>South Avalon</td>
<td>White sluggos</td>
<td>legal kings</td>
<td>21.1°C</td>
<td>0.8m E 8sec</td>
<td>5km/h NE</td>
<td>5 -8am</td>
<td>out-in 0.6-1m</td>
<td>22% full</td>
<td>no</td>
<td>sunny</td>
<td>2016</td>
<td>12</td>
<td>4</td>
<td>White sluggos</td>
<td>legal kings</td>
<td>21.1</td>
<td>0.8</td>
<td>22.0</td>
</tr>
<tr>
<th>256</th>
<td>2016-08-16</td>
<td>Shelly Beach</td>
<td>Prawns and bread</td>
<td>2x leather jacket</td>
<td>18.5°C</td>
<td>0.7m S 9sec</td>
<td>10km/h NW</td>
<td>5:30am - 9:00am</td>
<td>In-Out 1.3-1.0m</td>
<td>90% full</td>
<td>no</td>
<td>sunny</td>
<td>2016</td>
<td>8</td>
<td>16</td>
<td>Prawns and bread</td>
<td>2x leather jacket</td>
<td>18.5</td>
<td>0.7</td>
<td>90.0</td>
</tr>
<tr>
<th>160</th>
<td>2015-10-31</td>
<td>Avoca</td>
<td>bread</td>
<td>tiny zebra fish</td>
<td>19.5°C</td>
<td>1m ESE 6.6sec</td>
<td>13knots NE</td>
<td>5:30 - 9am</td>
<td>Incoming 0.5-1.4m</td>
<td>80% full</td>
<td>no</td>
<td>cloudy</td>
<td>2015</td>
<td>10</td>
<td>31</td>
<td>bread</td>
<td>tiny zebra fish</td>
<td>19.5</td>
<td>1.0</td>
<td>80.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The columns we want to keep.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'year'</span><span class="p">,</span><span class="s1">'month'</span><span class="p">,</span><span class="s1">'day'</span><span class="p">,</span><span class="s1">'spot'</span><span class="p">,</span>
                <span class="s1">'baits_lures'</span><span class="p">,</span><span class="s1">'fish_caught'</span><span class="p">,</span><span class="s1">'water_temp'</span><span class="p">,</span><span class="s1">'swell_magnitude'</span><span class="p">,</span>
               <span class="s1">'moon_phase_percent_full'</span><span class="p">]</span>
<span class="n">cols_to_keep</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>['date',
 'year',
 'month',
 'day',
 'spot',
 'baits_lures',
 'fish_caught',
 'water_temp',
 'swell_magnitude',
 'moon_phase_percent_full']</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Semi-cleaned data for the database</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>114</th>
<td>2015-04-26</td>
<td>2015</td>
<td>4</td>
<td>26</td>
<td>Janies Corner</td>
<td>Mullet Fillet</td>
<td>3x butter bream</td>
<td>21.3</td>
<td>1.5</td>
<td>50.0</td>
</tr>
<tr>
<th>129</th>
<td>2015-06-12</td>
<td>2015</td>
<td>6</td>
<td>12</td>
<td>The Boot</td>
<td>Squid leg</td>
<td>3x 30cm trevs</td>
<td>21.6</td>
<td>1.4</td>
<td>20.0</td>
</tr>
<tr>
<th>302</th>
<td>2016-12-04</td>
<td>2016</td>
<td>12</td>
<td>4</td>
<td>South Avalon</td>
<td>White sluggos</td>
<td>legal kings</td>
<td>21.1</td>
<td>0.8</td>
<td>22.0</td>
</tr>
<tr>
<th>256</th>
<td>2016-08-16</td>
<td>2016</td>
<td>8</td>
<td>16</td>
<td>Shelly Beach</td>
<td>Prawns and bread</td>
<td>2x leather jacket</td>
<td>18.5</td>
<td>0.7</td>
<td>90.0</td>
</tr>
<tr>
<th>160</th>
<td>2015-10-31</td>
<td>2015</td>
<td>10</td>
<td>31</td>
<td>Avoca</td>
<td>bread</td>
<td>tiny zebra fish</td>
<td>19.5</td>
<td>1.0</td>
<td>80.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><class 'pandas.core.frame.DataFrame'>
RangeIndex: 335 entries, 0 to 334
Data columns (total 10 columns):
date                       335 non-null object
year                       335 non-null int64
month                      335 non-null int64
day                        335 non-null int64
spot                       335 non-null object
baits_lures                335 non-null object
fish_caught                335 non-null object
water_temp                 330 non-null float64
swell_magnitude            326 non-null float64
moon_phase_percent_full    328 non-null float64
dtypes: float64(3), int64(3), object(4)
memory usage: 26.2+ KB
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">'postgresql+psycopg2://postgres:1@localhost:5432/fishing'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># such a powerful command, creating new table here called 'journalv3'</span>
<span class="n">df</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">'journalv3'</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'replace'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT * 
FROM journalv3
LIMIT 5
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[16]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
<tr>
<td>0</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>1</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>2</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>3</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>4</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
-- Useful to see table schema
SELECT column_name, data_type, character_maximum_length
FROM information_schema.columns 
WHERE table_name = 'journalv3'
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>11 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[17]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>column_name</th>
<th>data_type</th>
<th>character_maximum_length</th>
</tr>
<tr>
<td>index</td>
<td>bigint</td>
<td>None</td>
</tr>
<tr>
<td>date</td>
<td>text</td>
<td>None</td>
</tr>
<tr>
<td>year</td>
<td>bigint</td>
<td>None</td>
</tr>
<tr>
<td>month</td>
<td>bigint</td>
<td>None</td>
</tr>
<tr>
<td>day</td>
<td>bigint</td>
<td>None</td>
</tr>
<tr>
<td>spot</td>
<td>text</td>
<td>None</td>
</tr>
<tr>
<td>baits_lures</td>
<td>text</td>
<td>None</td>
</tr>
<tr>
<td>fish_caught</td>
<td>text</td>
<td>None</td>
</tr>
<tr>
<td>water_temp</td>
<td>double precision</td>
<td>None</td>
</tr>
<tr>
<td>swell_magnitude</td>
<td>double precision</td>
<td>None</td>
</tr>
<tr>
<td>moon_phase_percent_full</td>
<td>double precision</td>
<td>None</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="SQL-and-Pandas-cheatsheet">SQL and Pandas cheatsheet<a class="anchor-link" href="#SQL-and-Pandas-cheatsheet">¶</a></h1><hr/>
<p>Here we'll cover equivalent commands. I learned Pandas before SQL, so this helps me remember SQL syntax.</p>
<p>PostgreSQL is pretty flexible. It doesn't mind if you leave the semi-colon (;) off the end of statements and capitals don't matter for commands. In Jupyter notebook, there will be no highlighting of SQL, so it will look plain. I'm going to use:</p>
<ul>
<li>CAPITALS for all commands (SELECT,WHERE,etc)</li>
<li>lowercase for all variables (column names,etc) </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SELECT-(SQL)-and-selecting-(Pandas)">SELECT (SQL) and selecting (Pandas)<a class="anchor-link" href="#SELECT-(SQL)-and-selecting-(Pandas)">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT date, spot, fish_caught, swell_magnitude
FROM journalv3
LIMIT 6
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>6 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>date</th>
<th>spot</th>
<th>fish_caught</th>
<th>swell_magnitude</th>
</tr>
<tr>
<td>2010-09-09</td>
<td>North Whale</td>
<td>1x bonito</td>
<td>2.3</td>
</tr>
<tr>
<td>2010-09-09</td>
<td>North Whale</td>
<td>1x salmon</td>
<td>2.3</td>
</tr>
<tr>
<td>2010-04-08</td>
<td>North Whale</td>
<td>1x squid</td>
<td>1.2</td>
</tr>
<tr>
<td>2010-04-08</td>
<td>North Whale</td>
<td>1x bonito</td>
<td>1.2</td>
</tr>
<tr>
<td>2010-04-08</td>
<td>North Whale</td>
<td>1x snapper</td>
<td>1.2</td>
</tr>
<tr>
<td>2010-12-06</td>
<td>North Whale</td>
<td>1x Kingfish</td>
<td>1.4</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span><span class="p">[[</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'spot'</span><span class="p">,</span><span class="s1">'fish_caught'</span><span class="p">,</span><span class="s1">'swell_magnitude'</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[19]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>spot</th>
<th>fish_caught</th>
<th>swell_magnitude</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>North Whale</td>
<td>1x bonito</td>
<td>2.3</td>
</tr>
<tr>
<th>1</th>
<td>2010-09-09</td>
<td>North Whale</td>
<td>1x salmon</td>
<td>2.3</td>
</tr>
<tr>
<th>2</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>1x squid</td>
<td>1.2</td>
</tr>
<tr>
<th>3</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>1x bonito</td>
<td>1.2</td>
</tr>
<tr>
<th>4</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>1x snapper</td>
<td>1.2</td>
</tr>
<tr>
<th>5</th>
<td>2010-12-06</td>
<td>North Whale</td>
<td>1x Kingfish</td>
<td>1.4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="WHERE-(SQL)-and-filtering-(Pandas)">WHERE (SQL) and filtering (Pandas)<a class="anchor-link" href="#WHERE-(SQL)-and-filtering-(Pandas)">¶</a></h2><h3 id="Filtering-by-number">Filtering by number<a class="anchor-link" href="#Filtering-by-number">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM journalv3
WHERE swell_magnitude > 2
LIMIT 5
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
<tr>
<td>0</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>1</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>89</td>
<td>2014-01-29</td>
<td>2014</td>
<td>1</td>
<td>29</td>
<td>Middlehead North</td>
<td>Slimy mackerel</td>
<td>-</td>
<td>22.5</td>
<td>2.7</td>
<td>74.0</td>
</tr>
<tr>
<td>90</td>
<td>2014-01-29</td>
<td>2014</td>
<td>1</td>
<td>29</td>
<td>Middlehead North</td>
<td>Yakka</td>
<td>1x tiny tailor</td>
<td>22.5</td>
<td>2.7</td>
<td>74.0</td>
</tr>
<tr>
<td>91</td>
<td>2014-01-29</td>
<td>2014</td>
<td>1</td>
<td>29</td>
<td>Middlehead North</td>
<td>Squid/Prawn</td>
<td>tiny fish</td>
<td>22.5</td>
<td>2.7</td>
<td>74.0</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span><span class="p">[</span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">swell_magnitude</span> <span class="o">></span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[21]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>89</th>
<td>2014-01-29</td>
<td>2014</td>
<td>1</td>
<td>29</td>
<td>Middlehead North</td>
<td>Slimy mackerel</td>
<td>-</td>
<td>22.5</td>
<td>2.7</td>
<td>74.0</td>
</tr>
<tr>
<th>90</th>
<td>2014-01-29</td>
<td>2014</td>
<td>1</td>
<td>29</td>
<td>Middlehead North</td>
<td>Yakka</td>
<td>1x tiny tailor</td>
<td>22.5</td>
<td>2.7</td>
<td>74.0</td>
</tr>
<tr>
<th>91</th>
<td>2014-01-29</td>
<td>2014</td>
<td>1</td>
<td>29</td>
<td>Middlehead North</td>
<td>Squid/Prawn</td>
<td>tiny fish</td>
<td>22.5</td>
<td>2.7</td>
<td>74.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Filtering-by-String">Filtering by String<a class="anchor-link" href="#Filtering-by-String">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM journalv3
WHERE spot = 'North Whale' AND year = 2014
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
<tr>
<td>70</td>
<td>2014-12-22</td>
<td>2014</td>
<td>12</td>
<td>22</td>
<td>North Whale</td>
<td>Gars (snubnose)</td>
<td>2x tailor</td>
<td>21.2</td>
<td>1.2</td>
<td>50.0</td>
</tr>
<tr>
<td>71</td>
<td>2014-12-22</td>
<td>2014</td>
<td>12</td>
<td>22</td>
<td>North Whale</td>
<td>Metal slug</td>
<td>1x bonito</td>
<td>21.2</td>
<td>1.2</td>
<td>50.0</td>
</tr>
<tr>
<td>72</td>
<td>2014-12-22</td>
<td>2014</td>
<td>12</td>
<td>22</td>
<td>North Whale</td>
<td>Squid strips</td>
<td>1x kingfish (58cm)</td>
<td>21.2</td>
<td>1.2</td>
<td>50.0</td>
</tr>
<tr>
<td>73</td>
<td>2014-12-22</td>
<td>2014</td>
<td>12</td>
<td>22</td>
<td>North Whale</td>
<td>Squid strips</td>
<td>1x snapper (30cm)</td>
<td>21.2</td>
<td>1.2</td>
<td>50.0</td>
</tr>
<tr>
<td>78</td>
<td>2014-12-29</td>
<td>2014</td>
<td>12</td>
<td>29</td>
<td>North Whale</td>
<td>gars</td>
<td>-</td>
<td>22.7</td>
<td>1.0</td>
<td>50.0</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span><span class="p">[(</span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">spot</span> <span class="o">==</span> <span class="s1">'North Whale'</span><span class="p">)</span> <span class="o">&</span> <span class="p">(</span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2014</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[23]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>70</th>
<td>2014-12-22</td>
<td>2014</td>
<td>12</td>
<td>22</td>
<td>North Whale</td>
<td>Gars (snubnose)</td>
<td>2x tailor</td>
<td>21.2</td>
<td>1.2</td>
<td>50.0</td>
</tr>
<tr>
<th>71</th>
<td>2014-12-22</td>
<td>2014</td>
<td>12</td>
<td>22</td>
<td>North Whale</td>
<td>Metal slug</td>
<td>1x bonito</td>
<td>21.2</td>
<td>1.2</td>
<td>50.0</td>
</tr>
<tr>
<th>72</th>
<td>2014-12-22</td>
<td>2014</td>
<td>12</td>
<td>22</td>
<td>North Whale</td>
<td>Squid strips</td>
<td>1x kingfish (58cm)</td>
<td>21.2</td>
<td>1.2</td>
<td>50.0</td>
</tr>
<tr>
<th>73</th>
<td>2014-12-22</td>
<td>2014</td>
<td>12</td>
<td>22</td>
<td>North Whale</td>
<td>Squid strips</td>
<td>1x snapper (30cm)</td>
<td>21.2</td>
<td>1.2</td>
<td>50.0</td>
</tr>
<tr>
<th>78</th>
<td>2014-12-29</td>
<td>2014</td>
<td>12</td>
<td>29</td>
<td>North Whale</td>
<td>gars</td>
<td>-</td>
<td>22.7</td>
<td>1.0</td>
<td>50.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Filtering-rows-that-contain-null-values">Filtering rows that contain null values<a class="anchor-link" href="#Filtering-rows-that-contain-null-values">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM journalv3
WHERE water_temp IS NULL
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[24]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
<tr>
<td>0</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>1</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>2</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>3</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>4</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span><span class="p">[</span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">water_temp</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[25]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GROUP-BY-(SQL)-and-groupby-(Pandas)">GROUP BY (SQL) and groupby (Pandas)<a class="anchor-link" href="#GROUP-BY-(SQL)-and-groupby-(Pandas)">¶</a></h2><h3 id="Grouping-with-count-and-sort">Grouping with count and sort<a class="anchor-link" href="#Grouping-with-count-and-sort">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT spot, COUNT(*) 
FROM journalv3
GROUP BY spot
ORDER BY count DESC
LIMIT 7
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>7 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[26]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>spot</th>
<th>count</th>
</tr>
<tr>
<td>The Boot</td>
<td>37</td>
</tr>
<tr>
<td>Bluefish Main</td>
<td>34</td>
</tr>
<tr>
<td>North Bondi</td>
<td>32</td>
</tr>
<tr>
<td>Shelly Beach</td>
<td>19</td>
</tr>
<tr>
<td>North Whale</td>
<td>19</td>
</tr>
<tr>
<td>Mahon Pool</td>
<td>16</td>
</tr>
<tr>
<td>Shark Point</td>
<td>15</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'spot'</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[27]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>spot
The Boot         37
Bluefish Main    34
North Bondi      32
Shelly Beach     19
North Whale      19
Mahon Pool       16
Shark Point      15
dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Grouping-with-average">Grouping with average<a class="anchor-link" href="#Grouping-with-average">¶</a></h3><p>In this example we cast water_temp to a the numeric (using ::NUMERIC) data type before using the ROUND function. Since water_temp was originally the double precision (float 8) data type, we cannot use the ROUND function on it. This could be a property of PostgreSQL only.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT spot, ROUND(AVG(water_temp)::NUMERIC,2) AS avg_water_temp, COUNT(*)
FROM journalv3
GROUP BY spot
ORDER BY spot ASC
LIMIT 5
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[28]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>spot</th>
<th>avg_water_temp</th>
<th>count</th>
</tr>
<tr>
<td>Alexa Parade Cliff</td>
<td>21.00</td>
<td>1</td>
</tr>
<tr>
<td>Avoca</td>
<td>20.83</td>
<td>3</td>
</tr>
<tr>
<td>Bluefish #3.5</td>
<td>22.75</td>
<td>6</td>
</tr>
<tr>
<td>Bluefish #5</td>
<td>19.50</td>
<td>3</td>
</tr>
<tr>
<td>Bluefish Main</td>
<td>21.42</td>
<td>34</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># np.mean can be replaced by pd.DataFrame.mean</span>
<span class="n">df_journalv3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'spot'</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">'water_temp'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> 
                                  <span class="s1">'spot'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">})</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[29]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>water_temp</th>
<th>spot</th>
</tr>
<tr>
<th>spot</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>Alexa Parade Cliff</th>
<td>21.00</td>
<td>1</td>
</tr>
<tr>
<th>Avoca</th>
<td>20.83</td>
<td>3</td>
</tr>
<tr>
<th>Bluefish #3.5</th>
<td>22.75</td>
<td>6</td>
</tr>
<tr>
<th>Bluefish #5</th>
<td>19.50</td>
<td>3</td>
</tr>
<tr>
<th>Bluefish Main</th>
<td>21.42</td>
<td>34</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="JOIN-(SQL)-and-merge-(Pandas)">JOIN (SQL) and merge (Pandas)<a class="anchor-link" href="#JOIN-(SQL)-and-merge-(Pandas)">¶</a></h2><p>A little more cleaning required in order to join and makes sense.</p>
<p>I'll first separate our dataframe. Weather conditions can be separated from other variables.</p>
<ul>
<li>df_weatherv3 will contain our joint key (date+spot) and weather conditions (water_temp, swell_magnitude, moon_phase_percent_full)</li>
<li>journalv3 will contain our joint key (date+spot) and all other variables</li>
</ul>
<p>First step, creating our weather dataframe. Notice the duplicates.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_weatherv3</span> <span class="o">=</span> <span class="n">df_journalv3</span><span class="p">[[</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'spot'</span><span class="p">,</span><span class="s1">'water_temp'</span><span class="p">,</span><span class="s1">'swell_magnitude'</span><span class="p">,</span>
                             <span class="s1">'moon_phase_percent_full'</span><span class="p">]]</span>
<span class="n">df_weatherv3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[30]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>spot</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>North Whale</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2010-09-09</td>
<td>North Whale</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remove duplicates now that we have date+spot as our primary key.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_weatherv3</span> <span class="o">=</span> <span class="n">df_weatherv3</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'spot'</span><span class="p">],</span><span class="n">keep</span><span class="o">=</span><span class="s1">'first'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_weatherv3</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><class 'pandas.core.frame.DataFrame'>
Int64Index: 133 entries, 0 to 327
Data columns (total 5 columns):
date                       133 non-null object
spot                       133 non-null object
water_temp                 131 non-null float64
swell_magnitude            132 non-null float64
moon_phase_percent_full    129 non-null float64
dtypes: float64(3), object(2)
memory usage: 6.2+ KB
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_weatherv3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[33]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>spot</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>North Whale</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2010-04-08</td>
<td>North Whale</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>5</th>
<td>2010-12-06</td>
<td>North Whale</td>
<td>20.5</td>
<td>1.4</td>
<td>NaN</td>
</tr>
<tr>
<th>6</th>
<td>2011-08-07</td>
<td>Clovelly Cemetary</td>
<td>18.8</td>
<td>0.9</td>
<td>NaN</td>
</tr>
<tr>
<th>7</th>
<td>2013-07-04</td>
<td>North Whale</td>
<td>19.0</td>
<td>1.3</td>
<td>13.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our dataframe weatherv3 is ready. Next remove weather columns from journalv3.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv4</span> <span class="o">=</span> <span class="n">df_journalv3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'water_temp'</span><span class="p">,</span><span class="s1">'swell_magnitude'</span><span class="p">,</span>
                             <span class="s1">'moon_phase_percent_full'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv4</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[35]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
</tr>
<tr>
<th>1</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
</tr>
<tr>
<th>2</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
</tr>
<tr>
<th>3</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
</tr>
<tr>
<th>4</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now our two dataframes are ready we'll update SQL.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv4</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">'journalv4'</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'replace'</span><span class="p">)</span>
<span class="n">df_weatherv3</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">'weatherv3'</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'replace'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A quick look at our two SQL tables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM weatherv3
LIMIT 5
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[37]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>spot</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
<tr>
<td>0</td>
<td>2010-09-09</td>
<td>North Whale</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>2</td>
<td>2010-04-08</td>
<td>North Whale</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>5</td>
<td>2010-12-06</td>
<td>North Whale</td>
<td>20.5</td>
<td>1.4</td>
<td>None</td>
</tr>
<tr>
<td>6</td>
<td>2011-08-07</td>
<td>Clovelly Cemetary</td>
<td>18.8</td>
<td>0.9</td>
<td>None</td>
</tr>
<tr>
<td>7</td>
<td>2013-07-04</td>
<td>North Whale</td>
<td>19.0</td>
<td>1.3</td>
<td>13.0</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM journalv4
LIMIT 5
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[38]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
</tr>
<tr>
<td>0</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
</tr>
<tr>
<td>1</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
</tr>
<tr>
<td>2</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
</tr>
<tr>
<td>3</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
</tr>
<tr>
<td>4</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Types-of-Joins">Types of Joins<a class="anchor-link" href="#Types-of-Joins">¶</a></h3><p>The 4 main join types we have are left, right, inner and full. These sometimes go by different names and I won't be explaining each type here. Since the code is similar for all examples I'll only provide one example.</p>
<h3 id="INNER-JOIN-(SQL)-and-how='inner'-(Pandas)">INNER JOIN (SQL) and how='inner' (Pandas)<a class="anchor-link" href="#INNER-JOIN-(SQL)-and-how='inner'-(Pandas)">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM journalv4 AS j4
INNER JOIN weatherv3 as w3
ON j4.date = w3.date AND j4.spot = w3.spot
LIMIT 5
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[39]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>index_1</th>
<th>date_1</th>
<th>spot_1</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
<tr>
<td>1</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>0</td>
<td>2010-09-09</td>
<td>North Whale</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>0</td>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>0</td>
<td>2010-09-09</td>
<td>North Whale</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>4</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
<td>2</td>
<td>2010-04-08</td>
<td>North Whale</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>3</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>2</td>
<td>2010-04-08</td>
<td>North Whale</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>2</td>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
<td>2</td>
<td>2010-04-08</td>
<td>North Whale</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The result is a bit messy with the repeated index_1, date_1 and spot_1. It is best practice to always list columns we want and not use wildcard (*). The results are not identical, as you can see above that the indicies didn't keep the same order after they were joined.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT j4.date, j4.spot, j4.baits_lures, j4.fish_caught, w3.water_temp, w3.swell_magnitude, w3.moon_phase_percent_full
FROM journalv3 AS j4
INNER JOIN weatherv3 as w3
ON j4.date = w3.date AND j4.spot = w3.spot
LIMIT 5
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[40]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>date</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
<tr>
<td>2010-04-08</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>2010-04-08</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>2010-04-08</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>2010-09-09</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>2010-09-09</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_journalv4</span><span class="p">,</span><span class="n">df_weatherv3</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'spot'</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">'inner'</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[41]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The joins follow the template below. Where df (dataframe) is equivalent to a table.</p>
<p>PostgreSQL</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">df1</span>
<span class="p">[</span><span class="k">join</span> <span class="k">type</span><span class="p">]</span> <span class="n">df2</span>
<span class="k">ON</span> <span class="n">df1</span><span class="p">.</span><span class="n">key1</span> <span class="o">=</span> <span class="n">df2</span><span class="p">.</span><span class="n">key2</span>
</pre></div>
<p>Replace [join type] with:</p>
<ul>
<li>INNER JOIN</li>
<li>LEFT OUTER JOIN</li>
<li>RIGHT OUTER JOIN</li>
<li>FULL OUTER JOIN</li>
<li>CROSS JOIN</li>
</ul>
<p>Python</p>
<div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'key1'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'key2'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'join type'</span><span class="p">)</span>
</pre></div>
<p>Replace 'join type' with:</p>
<ul>
<li>inner</li>
<li>left</li>
<li>right</li>
<li>outer</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="UNION-(SQL)-and-concat-(Pandas)">UNION (SQL) and concat (Pandas)<a class="anchor-link" href="#UNION-(SQL)-and-concat-(Pandas)">¶</a></h2><p>Since this data doesn't require any union/concat let's make up some that does. I've taken samples from journalv3 and made two separate tables. Then I've created a duplicate entry in df1 for this example. Those tables have been written into SQL with tables of the same name.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df_journalv4</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df_journalv4</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">df1</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">'table1'</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'replace'</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">'table2'</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'replace'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[43]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
</tr>
</thead>
<tbody>
<tr>
<th>80</th>
<td>2014-12-29</td>
<td>2014</td>
<td>12</td>
<td>29</td>
<td>Inner Ovens</td>
<td>metals</td>
<td>1x squid</td>
</tr>
<tr>
<th>59</th>
<td>2014-10-31</td>
<td>2014</td>
<td>10</td>
<td>31</td>
<td>Ivo Rowe Pool</td>
<td>Cabbage weed</td>
<td>5x blackfish</td>
</tr>
<tr>
<th>258</th>
<td>2016-08-17</td>
<td>2016</td>
<td>8</td>
<td>17</td>
<td>Shelly Beach</td>
<td>Probably prawns and bread</td>
<td>4x drummer</td>
</tr>
<tr>
<th>198</th>
<td>2016-04-09</td>
<td>2016</td>
<td>4</td>
<td>9</td>
<td>Bluefish #3.5</td>
<td>surecatch knight 65g yellow</td>
<td>2x bonnies</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[44]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
</tr>
</thead>
<tbody>
<tr>
<th>198</th>
<td>2016-04-09</td>
<td>2016</td>
<td>4</td>
<td>9</td>
<td>Bluefish #3.5</td>
<td>surecatch knight 65g yellow</td>
<td>2x bonnies</td>
</tr>
<tr>
<th>221</th>
<td>2016-07-18</td>
<td>2016</td>
<td>7</td>
<td>18</td>
<td>Shark Point</td>
<td>squid wings</td>
<td>1x trev</td>
</tr>
<tr>
<th>7</th>
<td>2013-07-04</td>
<td>2013</td>
<td>7</td>
<td>4</td>
<td>North Whale</td>
<td>Zman 3.75" jerk</td>
<td>3x salmon</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Take a look at our tables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT table_name
FROM information_schema.tables
WHERE table_schema NOT IN ('pg_catalog', 'information_schema');
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[45]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>table_name</th>
</tr>
<tr>
<td>journalv3</td>
</tr>
<tr>
<td>journalv4</td>
</tr>
<tr>
<td>weatherv3</td>
</tr>
<tr>
<td>table1</td>
</tr>
<tr>
<td>table2</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="UNION-ALL-(SQL)-and-concat-(Pandas)">UNION ALL (SQL) and concat (Pandas)<a class="anchor-link" href="#UNION-ALL-(SQL)-and-concat-(Pandas)">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM table1
UNION ALL
SELECT *
FROM table2
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>7 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[46]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
</tr>
<tr>
<td>80</td>
<td>2014-12-29</td>
<td>2014</td>
<td>12</td>
<td>29</td>
<td>Inner Ovens</td>
<td>metals</td>
<td>1x squid</td>
</tr>
<tr>
<td>59</td>
<td>2014-10-31</td>
<td>2014</td>
<td>10</td>
<td>31</td>
<td>Ivo Rowe Pool</td>
<td>Cabbage weed</td>
<td>5x blackfish</td>
</tr>
<tr>
<td>258</td>
<td>2016-08-17</td>
<td>2016</td>
<td>8</td>
<td>17</td>
<td>Shelly Beach</td>
<td>Probably prawns and bread</td>
<td>4x drummer</td>
</tr>
<tr>
<td>198</td>
<td>2016-04-09</td>
<td>2016</td>
<td>4</td>
<td>9</td>
<td>Bluefish #3.5</td>
<td>surecatch knight 65g yellow</td>
<td>2x bonnies</td>
</tr>
<tr>
<td>198</td>
<td>2016-04-09</td>
<td>2016</td>
<td>4</td>
<td>9</td>
<td>Bluefish #3.5</td>
<td>surecatch knight 65g yellow</td>
<td>2x bonnies</td>
</tr>
<tr>
<td>221</td>
<td>2016-07-18</td>
<td>2016</td>
<td>7</td>
<td>18</td>
<td>Shark Point</td>
<td>squid wings</td>
<td>1x trev</td>
</tr>
<tr>
<td>7</td>
<td>2013-07-04</td>
<td>2013</td>
<td>7</td>
<td>4</td>
<td>North Whale</td>
<td>Zman 3.75" jerk</td>
<td>3x salmon</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[47]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
</tr>
</thead>
<tbody>
<tr>
<th>80</th>
<td>2014-12-29</td>
<td>2014</td>
<td>12</td>
<td>29</td>
<td>Inner Ovens</td>
<td>metals</td>
<td>1x squid</td>
</tr>
<tr>
<th>59</th>
<td>2014-10-31</td>
<td>2014</td>
<td>10</td>
<td>31</td>
<td>Ivo Rowe Pool</td>
<td>Cabbage weed</td>
<td>5x blackfish</td>
</tr>
<tr>
<th>258</th>
<td>2016-08-17</td>
<td>2016</td>
<td>8</td>
<td>17</td>
<td>Shelly Beach</td>
<td>Probably prawns and bread</td>
<td>4x drummer</td>
</tr>
<tr>
<th>198</th>
<td>2016-04-09</td>
<td>2016</td>
<td>4</td>
<td>9</td>
<td>Bluefish #3.5</td>
<td>surecatch knight 65g yellow</td>
<td>2x bonnies</td>
</tr>
<tr>
<th>198</th>
<td>2016-04-09</td>
<td>2016</td>
<td>4</td>
<td>9</td>
<td>Bluefish #3.5</td>
<td>surecatch knight 65g yellow</td>
<td>2x bonnies</td>
</tr>
<tr>
<th>221</th>
<td>2016-07-18</td>
<td>2016</td>
<td>7</td>
<td>18</td>
<td>Shark Point</td>
<td>squid wings</td>
<td>1x trev</td>
</tr>
<tr>
<th>7</th>
<td>2013-07-04</td>
<td>2013</td>
<td>7</td>
<td>4</td>
<td>North Whale</td>
<td>Zman 3.75" jerk</td>
<td>3x salmon</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="UNION-(SQL)-and-concat-(Pandas)">UNION (SQL) and concat (Pandas)<a class="anchor-link" href="#UNION-(SQL)-and-concat-(Pandas)">¶</a></h3><p>UNION removes duplicates where as UNION ALL does not.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM table1
UNION
SELECT *
FROM table2
ORDER BY index
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>6 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[48]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
</tr>
<tr>
<td>7</td>
<td>2013-07-04</td>
<td>2013</td>
<td>7</td>
<td>4</td>
<td>North Whale</td>
<td>Zman 3.75" jerk</td>
<td>3x salmon</td>
</tr>
<tr>
<td>59</td>
<td>2014-10-31</td>
<td>2014</td>
<td>10</td>
<td>31</td>
<td>Ivo Rowe Pool</td>
<td>Cabbage weed</td>
<td>5x blackfish</td>
</tr>
<tr>
<td>80</td>
<td>2014-12-29</td>
<td>2014</td>
<td>12</td>
<td>29</td>
<td>Inner Ovens</td>
<td>metals</td>
<td>1x squid</td>
</tr>
<tr>
<td>198</td>
<td>2016-04-09</td>
<td>2016</td>
<td>4</td>
<td>9</td>
<td>Bluefish #3.5</td>
<td>surecatch knight 65g yellow</td>
<td>2x bonnies</td>
</tr>
<tr>
<td>221</td>
<td>2016-07-18</td>
<td>2016</td>
<td>7</td>
<td>18</td>
<td>Shark Point</td>
<td>squid wings</td>
<td>1x trev</td>
</tr>
<tr>
<td>258</td>
<td>2016-08-17</td>
<td>2016</td>
<td>8</td>
<td>17</td>
<td>Shelly Beach</td>
<td>Probably prawns and bread</td>
<td>4x drummer</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># No column named index in the dataframe so we use .sort_index()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[49]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
</tr>
</thead>
<tbody>
<tr>
<th>7</th>
<td>2013-07-04</td>
<td>2013</td>
<td>7</td>
<td>4</td>
<td>North Whale</td>
<td>Zman 3.75" jerk</td>
<td>3x salmon</td>
</tr>
<tr>
<th>59</th>
<td>2014-10-31</td>
<td>2014</td>
<td>10</td>
<td>31</td>
<td>Ivo Rowe Pool</td>
<td>Cabbage weed</td>
<td>5x blackfish</td>
</tr>
<tr>
<th>80</th>
<td>2014-12-29</td>
<td>2014</td>
<td>12</td>
<td>29</td>
<td>Inner Ovens</td>
<td>metals</td>
<td>1x squid</td>
</tr>
<tr>
<th>198</th>
<td>2016-04-09</td>
<td>2016</td>
<td>4</td>
<td>9</td>
<td>Bluefish #3.5</td>
<td>surecatch knight 65g yellow</td>
<td>2x bonnies</td>
</tr>
<tr>
<th>221</th>
<td>2016-07-18</td>
<td>2016</td>
<td>7</td>
<td>18</td>
<td>Shark Point</td>
<td>squid wings</td>
<td>1x trev</td>
</tr>
<tr>
<th>258</th>
<td>2016-08-17</td>
<td>2016</td>
<td>8</td>
<td>17</td>
<td>Shelly Beach</td>
<td>Probably prawns and bread</td>
<td>4x drummer</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Split our fish_caught into number of fish caught and species. Then update our SQL entry.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[50]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>date</th>
<th>year</th>
<th>month</th>
<th>day</th>
<th>spot</th>
<th>baits_lures</th>
<th>fish_caught</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2010-09-09</td>
<td>2010</td>
<td>9</td>
<td>9</td>
<td>North Whale</td>
<td>Zipbaits System Minnow 15HD</td>
<td>1x salmon</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x squid</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Metals</td>
<td>1x bonito</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2010-04-08</td>
<td>2010</td>
<td>4</td>
<td>8</td>
<td>North Whale</td>
<td>Jackall TN70</td>
<td>1x snapper</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'number_of_fish_caught'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'fish_caught'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">'^(.*?)x'</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'number_of_fish_caught'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'number_of_fish_caught'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span> 

<span class="n">df</span><span class="p">[</span><span class="s1">'fish_species_caught'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'fish_caught'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">'x(.*?)$'</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'fish_species_caught'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'fish_species_caught'</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'year'</span><span class="p">,</span><span class="s1">'month'</span><span class="p">,</span><span class="s1">'day'</span><span class="p">,</span><span class="s1">'spot'</span><span class="p">,</span>
                <span class="s1">'baits_lures'</span><span class="p">,</span><span class="s1">'number_of_fish_caught'</span><span class="p">,</span><span class="s1">'fish_species_caught'</span><span class="p">,</span>
                <span class="s1">'water_temp'</span><span class="p">,</span><span class="s1">'swell_magnitude'</span><span class="p">,</span><span class="s1">'moon_phase_percent_full'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [54]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><class 'pandas.core.frame.DataFrame'>
RangeIndex: 335 entries, 0 to 334
Data columns (total 11 columns):
date                       335 non-null object
year                       335 non-null int64
month                      335 non-null int64
day                        335 non-null int64
spot                       335 non-null object
baits_lures                335 non-null object
number_of_fish_caught      335 non-null int64
fish_species_caught        260 non-null object
water_temp                 330 non-null float64
swell_magnitude            326 non-null float64
moon_phase_percent_full    328 non-null float64
dtypes: float64(3), int64(4), object(4)
memory usage: 28.9+ KB
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">'journalv3'</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'replace'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="More-examples">More examples<a class="anchor-link" href="#More-examples">¶</a></h1><hr/>
<h2 id="Creating-a-median-function">Creating a median function<a class="anchor-link" href="#Creating-a-median-function">¶</a></h2><p>This median function works for any element. From the <a href="https://wiki.postgresql.org/wiki/Aggregate_Median">PostgreSQL wiki</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>
-- Creating the median function

CREATE FUNCTION _final_median(anyarray) RETURNS float8 AS $$ 
  WITH q AS
  (
     SELECT val
     FROM unnest($1) val
     WHERE VAL IS NOT NULL
     ORDER BY 1
  ),
  cnt AS
  (
    SELECT COUNT(*) AS c FROM q
  )
  SELECT AVG(val)::float8
  FROM 
  (
    SELECT val FROM q
    LIMIT  2 - MOD((SELECT c FROM cnt), 2)
    OFFSET GREATEST(CEIL((SELECT c FROM cnt) / 2.0) - 1,0)  
  ) q2;
$$ LANGUAGE SQL IMMUTABLE;
 
CREATE AGGREGATE median(anyelement) (
  SFUNC=array_append,
  STYPE=anyarray,
  FINALFUNC=_final_median,
  INITCOND='{}'
);
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(psycopg2.ProgrammingError) function "_final_median" already exists with same argument types
 [SQL: '-- Creating the median function\n\nCREATE FUNCTION _final_median(anyarray) RETURNS float8 AS $$ \n  WITH q AS\n  (\n     SELECT val\n     FROM unnest($1) val\n     WHERE VAL IS NOT NULL\n     ORDER BY 1\n  ),\n  cnt AS\n  (\n    SELECT COUNT(*) AS c FROM q\n  )\n  SELECT AVG(val)::float8\n  FROM \n  (\n    SELECT val FROM q\n    LIMIT  2 - MOD((SELECT c FROM cnt), 2)\n    OFFSET GREATEST(CEIL((SELECT c FROM cnt) / 2.0) - 1,0)  \n  ) q2;\n$$ LANGUAGE SQL IMMUTABLE;']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Common-Table-Expressions-(CTEs)-aka-WITH-clauses">Common Table Expressions (CTEs) aka WITH clauses<a class="anchor-link" href="#Common-Table-Expressions-(CTEs)-aka-WITH-clauses">¶</a></h2><p>We can use this feature to make our code more readable. Another advantage is allowing us to work top down instead of inside out, which is more logical to me. We sacrifice execution speed, however we can always optimise later.</p>
<p>For this example we'll say we want to find the best spots for catching fish with 'cabbage' as bait. We'll define 'best spots' as  a greater number of average fish caught than the median. We'll also filter for swell_magnitude between 1-2m.</p>
<p>NOTES:</p>
<ul>
<li>BETWEEN is inclusive of bounds. a BETWEEN 1 AND 2 = a >=1 AND a <=2.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [57]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

-- Start with all spots, swells and fish caught on cabbage weed 
WITH cabbage_catches AS (
    SELECT spot, swell_magnitude, baits_lures, number_of_fish_caught
    FROM journalv3
    WHERE baits_lures ILIKE '%cabbage%' AND number_of_fish_caught > 0
),

-- Count of fish_caught per location for swell between 1-2m
fish_per_spot AS (
    SELECT spot, ROUND(AVG(number_of_fish_caught),2) AS avg_fish_count
    FROM cabbage_catches
    WHERE swell_magnitude BETWEEN 1 AND 2
    GROUP BY spot
),

-- Median fish count overall
overall_median_fish_count AS (
    SELECT MEDIAN(avg_fish_count) AS med
    FROM fish_per_spot
),

-- Top 50% of spots by fish count
best_cabbage_spots AS (
    SELECT spot, avg_fish_count
    FROM fish_per_spot, overall_median_fish_count
    WHERE avg_fish_count > med
    ORDER BY avg_fish_count DESC
)

-- Need this final SELECT for the WITH statement to work 
SELECT * 
FROM best_cabbage_spots
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[57]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>spot</th>
<th>avg_fish_count</th>
</tr>
<tr>
<td>Mahon Pool</td>
<td>10.00</td>
</tr>
<tr>
<td>Dudley Beach Rocks</td>
<td>7.50</td>
</tr>
<tr>
<td>Ivo Rowe Pool</td>
<td>5.00</td>
</tr>
<tr>
<td>Little Bluey</td>
<td>4.00</td>
</tr>
<tr>
<td>North Bondi</td>
<td>3.00</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this stage I'm not sure how to recreate the above with subqueries. Onto pandas!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_journalv3</span><span class="p">[(</span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">baits_lures</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">'cabbage'</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="o">&</span>
            <span class="p">(</span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">number_of_fish_caught</span> <span class="o">></span> <span class="mi">0</span><span class="p">)</span> <span class="o">&</span>
            <span class="p">(</span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">swell_magnitude</span> <span class="o">>=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&</span>
            <span class="p">(</span><span class="n">df_journalv3</span><span class="o">.</span><span class="n">swell_magnitude</span> <span class="o"><=</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'spot'</span>
            <span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">'number_of_fish_caught'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df_temp</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[58]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>number_of_fish_caught</th>
</tr>
<tr>
<th>spot</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>Dudley Beach Rocks</th>
<td>7.50</td>
</tr>
<tr>
<th>Ivo Rowe Pool</th>
<td>5.00</td>
</tr>
<tr>
<th>Killalea</th>
<td>2.00</td>
</tr>
<tr>
<th>Little Bluey</th>
<td>4.00</td>
</tr>
<tr>
<th>Mahon Pool</th>
<td>10.00</td>
</tr>
<tr>
<th>Maroubra Beach</th>
<td>2.00</td>
</tr>
<tr>
<th>North Bondi</th>
<td>3.00</td>
</tr>
<tr>
<th>The Blessings</th>
<td>2.00</td>
</tr>
<tr>
<th>The Boot</th>
<td>2.33</td>
</tr>
<tr>
<th>The Gutter</th>
<td>1.00</td>
</tr>
<tr>
<th>The Trap</th>
<td>2.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [59]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">med</span> <span class="o">=</span> <span class="n">df_temp</span><span class="p">[</span><span class="s1">'number_of_fish_caught'</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">med</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[59]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>2.33</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [60]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_temp</span><span class="p">[</span><span class="n">df_temp</span><span class="o">.</span><span class="n">number_of_fish_caught</span> <span class="o">></span> <span class="n">med</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'number_of_fish_caught'</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[60]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>number_of_fish_caught</th>
</tr>
<tr>
<th>spot</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>Mahon Pool</th>
<td>10.0</td>
</tr>
<tr>
<th>Dudley Beach Rocks</th>
<td>7.5</td>
</tr>
<tr>
<th>Ivo Rowe Pool</th>
<td>5.0</td>
</tr>
<tr>
<th>Little Bluey</th>
<td>4.0</td>
</tr>
<tr>
<th>North Bondi</th>
<td>3.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reading-from-SQL">Reading from SQL<a class="anchor-link" href="#Reading-from-SQL">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [61]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

SELECT *
FROM weatherv3
LIMIT 5
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5 rows affected.
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[61]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
<tr>
<th>index</th>
<th>date</th>
<th>spot</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
<tr>
<td>0</td>
<td>2010-09-09</td>
<td>North Whale</td>
<td>None</td>
<td>2.3</td>
<td>None</td>
</tr>
<tr>
<td>2</td>
<td>2010-04-08</td>
<td>North Whale</td>
<td>None</td>
<td>1.2</td>
<td>None</td>
</tr>
<tr>
<td>5</td>
<td>2010-12-06</td>
<td>North Whale</td>
<td>20.5</td>
<td>1.4</td>
<td>None</td>
</tr>
<tr>
<td>6</td>
<td>2011-08-07</td>
<td>Clovelly Cemetary</td>
<td>18.8</td>
<td>0.9</td>
<td>None</td>
</tr>
<tr>
<td>7</td>
<td>2013-07-04</td>
<td>North Whale</td>
<td>19.0</td>
<td>1.3</td>
<td>13.0</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [62]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">'weatherv3'</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[62]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>index</th>
<th>date</th>
<th>spot</th>
<th>water_temp</th>
<th>swell_magnitude</th>
<th>moon_phase_percent_full</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>2010-09-09</td>
<td>North Whale</td>
<td>NaN</td>
<td>2.3</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>2010-04-08</td>
<td>North Whale</td>
<td>NaN</td>
<td>1.2</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>5</td>
<td>2010-12-06</td>
<td>North Whale</td>
<td>20.5</td>
<td>1.4</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>6</td>
<td>2011-08-07</td>
<td>Clovelly Cemetary</td>
<td>18.8</td>
<td>0.9</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>7</td>
<td>2013-07-04</td>
<td>North Whale</td>
<td>19.0</td>
<td>1.3</td>
<td>13.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a></h1><hr/>
<p>In this notebook we learned how to read and write data between PostgreSQL and Python.</p>
<h2 id="Limitations">Limitations<a class="anchor-link" href="#Limitations">¶</a></h2><p>We only used PostgreSQL and there are many more examples we can cover.</p>
<h2 id="Future-Work">Future Work<a class="anchor-link" href="#Future-Work">¶</a></h2><p>More examples and complete real world problems with SQL and Python.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">References<a class="anchor-link" href="#References">¶</a></h1><hr/>
<p><a href="https://www.compose.com/articles/getting-started-with-compose-postgresql-and-jupyter-notebooks/">Compose - Getting Started with Compose PostgreSQL and Jupyter Notebooks</a> 2018</p>
<p><a href="https://blog.rjmetrics.com/2016/02/08/setting-up-your-analytics-stack-with-jupyter-notebook-aws-redshift/">TheDataPoint - Setting up Your Analytics Stack with Jupyter Notebook & AWS Redshift</a> 2018</p>
<p><a href="https://initd.org/psycopg/">Psycopg - PostgreSQL adapter for Python</a> 2018</p>
<p><a href="https://www.sqlalchemy.org/">SQL Alchemy - The Python SQL Toolkit and Object Relational Mapper</a> 2018</p>
<p><a href="https://github.com/nithinmurali/pygsheets">pygsheets - Google Spreadsheets Python API v4</a> 2018</p>
<p><a href="https://github.com/catherinedevlin/ipython-sql">Python-SQL Magic</a> 2018</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/">Official Pandas Documentation</a> 2018</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Chris Said's script to hide a bunch of stuff</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">HTML</span>
<span class="n">HTML</span><span class="p">(</span><span class="s1">'''<script></span>
<span class="s1">  $(document).ready(function(){</span>
<span class="s1">    $('div.prompt').hide();</span>
<span class="s1">    $('div.back-to-top').hide();</span>
<span class="s1">    $('nav#menubar').hide();</span>
<span class="s1">    $('.breadcrumb').hide();</span>
<span class="s1">    $('.hidden-print').hide();</span>
<span class="s1">  });</span>
<span class="s1"></script></span>
<span class="s1">'''</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[63]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<script>
  $(document).ready(function(){
    $('div.prompt').hide();
    $('div.back-to-top').hide();
    $('nav#menubar').hide();
    $('.breadcrumb').hide();
    $('.hidden-print').hide();
  });
</script>
</div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </div>

        <div class="meta">
            <div>
                    <a href="https://jasonwillschiu.github.io/tag/python.html" class="tag">python</a>
                    <a href="https://jasonwillschiu.github.io/tag/jupyter-notebooks.html" class="tag">jupyter notebooks</a>
                    <a href="https://jasonwillschiu.github.io/tag/pandas.html" class="tag">pandas</a>
                    <a href="https://jasonwillschiu.github.io/tag/api.html" class="tag">api</a>
                    <a href="https://jasonwillschiu.github.io/tag/sql.html" class="tag">sql</a>
            </div>
        </div>
    </article>

  <section>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
    <script type="text/javascript">
      var disqus_shortname = 'jasonwillschiu';
      var disqus_identifier = '/blog/2018-02-05-SQLPandas1/';
      var disqus_url = 'https://jasonwillschiu.github.io/blog/2018-02-05-SQLPandas1/';
      var disqus_title = 'SQL and Pandas - Book 1 - Passing Data and Comparing Commands';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </section>

</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
    margin: .2em 0.4em;
    max-width: 580px;
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>
<!--
    <footer>
      <p>
        © 2012-2017 Jason Wills Chiu, license <a href=""> </a>
        unless otherwise noted.
        Generated by <a href= "https://docs.getpelican.com/">Pelican</a>.
      </p>
    </footer>
-->
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-109814892-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-109814892-1');
    ga('send', 'pageview');
</script>
    </body>
</html>